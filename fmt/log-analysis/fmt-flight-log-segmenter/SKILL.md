---
name: fmt-flight-log-segmenter
description: 基于已解码的 FMT 飞行日志数据，对飞行阶段（起飞/巡航/过渡/返航/降落等）进行分段并建立关键事件索引的专用技能。用于为后续控制性能分析和调参报告提供时间段上下文；不负责底层二进制解码或最终调参建议。
---

# FMT Flight Log Segmenter

## 目标

把“长日志”切成可解释的飞行阶段与关键事件段，形成后续分析的时间索引。

## 前置输入（理想）

1. 已解码 `mlog` 数据（至少包含 `FMS_Out`, `INS_Out`, `Control_Out`）
2. 可选 `ulog.txt`（用于辅助事件解释）
3. 当前机型变体信息（`vtol` / `mc` / `fw`）

## 聚焦范围（只做这些）

1. 飞行阶段划分（Flight Phase Segmentation）
2. 关键事件索引（解锁、模式切换、过渡、异常、降落等）
3. 分段质量评估（数据缺失/状态不连续）

## 不负责

1. `mlog` 二进制解码
2. 控制参数调优建议
3. 深入控制器根因分析

## 分段优先信号（FMT 推荐）

1. `FMS_Out.status`
2. `FMS_Out.state`
3. `FMS_Out.ext_state`（VTOL 重点）
4. `FMS_Out.mode` / `FMS_Out.ctrl_mode`
5. `Control_Out.actuator_cmd`
6. `INS_Out` 高度/速度/姿态变化

## 执行步骤

1. 检查关键信号是否存在、时间轴是否可用。
2. 用 `FMS_Out` 字段建立主分段（模式/状态驱动）。
3. 用 `INS_Out` 与执行器输出修正边界（例如起飞/着陆窗口）。
4. 对 VTOL 日志单独标出过渡段（`ext_state` 变化）。
5. 建立事件索引表（timestamp、事件类型、证据信号）。

## 输出要求

至少包含：

1. 飞行阶段时间轴（阶段名、起止时间）
2. 关键事件索引（含证据信号）
3. 分段依据说明（字段与阈值/规则）
4. 分段质量问题（缺数据、状态跳变、边界模糊）
5. 对后续性能分析的建议观察窗口

## 纪律约束

1. 分段规则要可复现（写清用哪些字段和阈值/条件）。
2. 不把性能现象当成分段依据的唯一来源。
3. VTOL 与非 VTOL 的规则分开说明。
